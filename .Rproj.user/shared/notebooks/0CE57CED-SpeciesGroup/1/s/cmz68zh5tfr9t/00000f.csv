"0","# If needed once: install.packages(c(""sf"",""ozmaps"",""ggplot2""))"
"0",""
"0","#library(ggplot2)"
"0","# 1) Clean + aggregate your data"
"0","dat <- data_2022"
"0","dat$state_territory <- trimws(dat$state_territory)"
"0","dat$state_territory[is.na(dat$state_territory) | dat$state_territory == """"] <- ""Unknown"""
"0","dat$state_territory[tolower(dat$state_territory) %in% c(""unknown1"",""unknown 1"",""unknown"")] <- ""Unknown"""
"0",""
"0","agg <- aggregate(occurrence_count ~ state_territory, data = dat, sum, na.rm = TRUE)"
"0",""
"0","# keep only real AU states/territories for mapping"
"0","keep <- c(""New South Wales"",""Victoria"",""Queensland"",""South Australia"","
"0","          ""Western Australia"",""Tasmania"",""Northern Territory"","
"0","          ""Australian Capital Territory"")"
"0","agg <- subset(agg, state_territory %in% keep)"
"0",""
"0","# 2) Get state polygons and join totals"
"0","states <- ozmaps::ozmap_data(""states"")   # has a NAME column with state names"
"0","plot_sf <- merge(states, agg, by.x = ""NAME"", by.y = ""state_territory"", all.x = TRUE, sort = FALSE)"
"0","plot_sf$occurrence_count[is.na(plot_sf$occurrence_count)] <- 0"
"0",""
"0","# 3) Choropleth (heat map)"
"0","options(scipen = 999)"
"0","ggplot(plot_sf) +"
"0","  geom_sf(aes(fill = occurrence_count), color = ""white"", linewidth = 0.25) +"
"0","  scale_fill_gradient("
"0","    name = ""Occurrences"","
"0","    low = ""#e6f2ff"", high = ""#084594"","
"0","    labels = function(x) prettyNum(x, big.mark = "","", scientific = FALSE)"
"0","    # If values are very skewed, use log colour scale instead:"
"0","    # , trans = ""log10"", name = ""Occurrences (log)"""
"0","  ) +"
"0","  coord_sf(xlim = c(112, 154), ylim = c(-44, -10), expand = FALSE) +"
"0","  labs(title = ""Total occurrences by State/Territory (cleaned data)"", x = NULL, y = NULL) +"
"0","  theme_void(base_size = 12) +"
"0","  theme(legend.position = ""right"")"
